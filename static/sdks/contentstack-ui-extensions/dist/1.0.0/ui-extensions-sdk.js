!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.ContentstackUIExtension=n():e.ContentstackUIExtension=n()}(window,function(){return function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=10)}([function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();var o=function(){function e(n,r,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.uid=n.data.uid,this.data_type=n.data.schema.data_type,this.schema=n.data.schema,this._data=n.data.value,this._connection=r;var o=this;t.on("entryUpdate",function(e){var n=e.data[o.uid];o._data!==n&&o._data})}return t(e,[{key:"setData",value:function(e){var n=this,r=this,t={data:e,uid:r.uid};return this._connection.sendToParent("setData",t).then(function(){return n._data=e,Promise.resolve(r)}).catch(function(e){return Promise.reject(e)})}},{key:"getData",value:function(){return this._data}},{key:"setFocus",value:function(){return this._connection.sendToParent("focus")}}]),e}();n.default=o},function(e,n,r){"use strict";e.exports=r(7),e.exports.default=e.exports},function(e,n,r){"use strict";var t,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(n){function i(){}var s=i.prototype,a=n.EventEmitter;function c(e,n){for(var r=e.length;r--;)if(e[r].listener===n)return r;return-1}function u(e){return function(){return this[e].apply(this,arguments)}}s.getListeners=function(e){var n,r,t=this._getEvents();if(e instanceof RegExp)for(r in n={},t)t.hasOwnProperty(r)&&e.test(r)&&(n[r]=t[r]);else n=t[e]||(t[e]=[]);return n},s.flattenListeners=function(e){var n,r=[];for(n=0;n<e.length;n+=1)r.push(e[n].listener);return r},s.getListenersAsObject=function(e){var n,r=this.getListeners(e);return r instanceof Array&&((n={})[e]=r),n||r},s.addListener=function(e,n){if(!function e(n){return"function"==typeof n||n instanceof RegExp||!(!n||"object"!==(void 0===n?"undefined":o(n)))&&e(n.listener)}(n))throw new TypeError("listener must be a function");var r,t=this.getListenersAsObject(e),i="object"===(void 0===n?"undefined":o(n));for(r in t)t.hasOwnProperty(r)&&-1===c(t[r],n)&&t[r].push(i?n:{listener:n,once:!1});return this},s.on=u("addListener"),s.addOnceListener=function(e,n){return this.addListener(e,{listener:n,once:!0})},s.once=u("addOnceListener"),s.defineEvent=function(e){return this.getListeners(e),this},s.defineEvents=function(e){for(var n=0;n<e.length;n+=1)this.defineEvent(e[n]);return this},s.removeListener=function(e,n){var r,t,o=this.getListenersAsObject(e);for(t in o)o.hasOwnProperty(t)&&-1!==(r=c(o[t],n))&&o[t].splice(r,1);return this},s.off=u("removeListener"),s.addListeners=function(e,n){return this.manipulateListeners(!1,e,n)},s.removeListeners=function(e,n){return this.manipulateListeners(!0,e,n)},s.manipulateListeners=function(e,n,r){var t,i,s=e?this.removeListener:this.addListener,a=e?this.removeListeners:this.addListeners;if("object"!==(void 0===n?"undefined":o(n))||n instanceof RegExp)for(t=r.length;t--;)s.call(this,n,r[t]);else for(t in n)n.hasOwnProperty(t)&&(i=n[t])&&("function"==typeof i?s.call(this,t,i):a.call(this,t,i));return this},s.removeEvent=function(e){var n,r=void 0===e?"undefined":o(e),t=this._getEvents();if("string"===r)delete t[e];else if(e instanceof RegExp)for(n in t)t.hasOwnProperty(n)&&e.test(n)&&delete t[n];else delete this._events;return this},s.removeAllListeners=u("removeEvent"),s.emitEvent=function(e,n){var r,t,o,i,s=this.getListenersAsObject(e);for(i in s)if(s.hasOwnProperty(i))for(r=s[i].slice(0),o=0;o<r.length;o++)!0===(t=r[o]).once&&this.removeListener(e,t.listener),t.listener.apply(this,n||[])===this._getOnceReturnValue()&&this.removeListener(e,t.listener);return this},s.trigger=u("emitEvent"),s.emit=function(e){var n=Array.prototype.slice.call(arguments,1);return this.emitEvent(e,n)},s.setOnceReturnValue=function(e){return this._onceReturnValue=e,this},s._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},s._getEvents=function(){return this._events||(this._events={})},i.noConflict=function(){return n.EventEmitter=a,i},void 0===(t=function(){return i}.call(n,r,n,e))||(e.exports=t)}({})},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(r(0));var i=function(){function e(n,r,t){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.content_type=n.data.content_type,this._data=n.data.entry,this.locale=n.data.locale,this._connection=r,this._emitter=t;var o=this;this._emitter.on("entryUpdate",function(e){o._data=e.data})}return t(e,[{key:"getData",value:function(){return this._data}},{key:"getField",value:function(e){if(this._data[e]){var n=this.content_type.schema.find(function(n){return n.uid===e}),r={data:{uid:e,value:this._data[e],schema:n,data_type:n.data_type}},t=new o.default(r,this._connection,this._emitter);return t.setData=null,t}throw Error("Invalid uid, Field not found")}},{key:"onChange",value:function(e){if(!e||"function"!=typeof e)throw Error("Callback must be a function");this._emitter.on("entryUpdate",function(n){e(n.data)})}}]),e}();n.default=i},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();var o=function(){function e(n,r){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._connection=r,this._data=n}return t(e,[{key:"getData",value:function(){return this._data}},{key:"getContentType",value:function(e,n){if(!e)return Promise.reject("uid is required");var r={uid:e,params:n=n||{},action:"getContentType"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getContentTypes",value:function(e,n){e=e||{},(n=n||{}).query=e;var r={params:n,action:"getContentTypes"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getEntry",value:function(e,n,r){if(!e)return Promise.reject("uid is required");if(!n)return Promise.reject("content_type_uid is required");var t={uid:e,content_type_uid:n,params:r=r||{},action:"getEntry"};return this._connection.sendToParent("stackQuery",t).then(i).catch(s)}},{key:"getEntries",value:function(e,n,r){if(!e)return Promise.reject("content_type_uid is required");n=n||{},(r=r||{}).query=n;var t={content_type_uid:e,params:r,action:"getEntries"};return this._connection.sendToParent("stackQuery",t).then(i).catch(s)}},{key:"getAsset",value:function(e,n){if(!e)return Promise.reject("uid is required");var r={uid:e,params:n=n||{},action:"getAsset"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getAssets",value:function(e,n){e=e||{},(n=n||{}).query=e;var r={params:n,action:"getAssets"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getEnvironment",value:function(e,n){if(!e)return Promise.reject("name is required");var r={name:e,params:n=n||{},action:"getEnvironment"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getEnvironments",value:function(e,n){e=e||{},(n=n||{}).query=e;var r={params:n,action:"getEnvironments"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getLocale",value:function(e,n){if(!e)return Promise.reject("code is required");var r={code:e,params:n=n||{},action:"getLocale"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}},{key:"getLocales",value:function(e,n){e=e||{},(n=n||{}).query=e;var r={params:n,action:"getLocales"};return this._connection.sendToParent("stackQuery",r).then(i).catch(s)}}]),e}();function i(e){return"string"==typeof e.data?Promise.reject(e.data):Promise.resolve(e.data)}function s(e){return Promise.reject(e)}n.default=o},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}();var o={attributes:!0,childList:!0,subtree:!0},i=void 0,s=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._connection=n,this._height,this._autoResizingEnabled=!1}return t(e,[{key:"updateHeight",value:function(e){return e&&!isNaN(e)||(e=Math.ceil(document.documentElement.getBoundingClientRect().height)),this._height===e?Promise.resolve():(this._height=e,this._connection.sendToParent("resize",e))}},{key:"enableAutoResizing",value:function(){return this._autoResizingEnabled?this:(this._autoResizingEnabled=!0,i=new MutationObserver(this.updateHeight.bind(this)),window.document.body&&i.observe(window.document.body,o),this)}},{key:"disableAutoResizing",value:function(){return this._autoResizingEnabled?(this._autoResizingEnabled=!1,i.disconnect(),this):this}}]),e}();n.default=s},function(e,n,r){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,n,r){"use strict";(function(e){var r,t,o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(s,a){"object"==i(n)&&"object"==i(e)?e.exports=a():(t=[],void 0===(o="function"==typeof(r=a)?r.apply(n,t):r)||(e.exports=o))}("undefined"!=typeof self&&self,function(){return function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s="./src/index.js")}({"./node_modules/cross-domain-safe-weakmap/src/index.js":function(e,n,r){n.__esModule=!0;var t=r("./node_modules/cross-domain-safe-weakmap/src/interface.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}(t);n.default=o},"./node_modules/cross-domain-safe-weakmap/src/interface.js":function(e,n,r){n.__esModule=!0;var t=r("./node_modules/cross-domain-safe-weakmap/src/weakmap.js");Object.defineProperty(n,"WeakMap",{enumerable:!0,get:function(){return t.CrossDomainSafeWeakMap}})},"./node_modules/cross-domain-safe-weakmap/src/native.js":function(e,n,r){n.__esModule=!0,n.hasNativeWeakMap=function(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,n={};return window.Object.freeze(n),e.set(n,"__testvalue__"),"__testvalue__"===e.get(n)}catch(e){return!1}}},"./node_modules/cross-domain-safe-weakmap/src/util.js":function(e,n,r){n.__esModule=!0,n.safeIndexOf=function(e,n){for(var r=0;r<e.length;r++)try{if(e[r]===n)return r}catch(e){}return-1},n.noop=function(){}},"./node_modules/cross-domain-safe-weakmap/src/weakmap.js":function(e,n,r){n.__esModule=!0,n.CrossDomainSafeWeakMap=void 0;var t=r("./node_modules/cross-domain-utils/src/index.js"),o=r("./node_modules/cross-domain-safe-weakmap/src/native.js"),i=r("./node_modules/cross-domain-safe-weakmap/src/util.js"),s=Object.defineProperty,a=Date.now()%1e9;n.CrossDomainSafeWeakMap=function(){function e(){if(function(n,r){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this),a+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+a,(0,o.hasNativeWeakMap)())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return e.prototype._cleanupClosedWindows=function(){for(var e=this.weakmap,n=this.keys,r=0;r<n.length;r++){var o=n[r];if((0,t.isWindow)(o)&&(0,t.isWindowClosed)(o)){if(e)try{e.delete(o)}catch(e){}n.splice(r,1),this.values.splice(r,1),r-=1}}},e.prototype.isSafeToReadWrite=function(e){if((0,t.isWindow)(e))return!1;try{(0,i.noop)(e&&e.self),(0,i.noop)(e&&e[this.name])}catch(e){return!1}return!0},e.prototype.set=function(e,n){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.set(e,n)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=this.name,o=e[t];o&&o[0]===e?o[1]=n:s(e,t,{value:[e,n],writable:!0})}else{this._cleanupClosedWindows();var a=this.keys,c=this.values,u=(0,i.safeIndexOf)(a,e);-1===u?(a.push(e),c.push(n)):c[u]=n}},e.prototype.get=function(e){if(!e)throw new Error("WeakMap expected key");var n=this.weakmap;if(n)try{if(n.has(e))return n.get(e)}catch(e){delete this.weakmap}if(!this.isSafeToReadWrite(e)){this._cleanupClosedWindows();var r=this.keys,t=(0,i.safeIndexOf)(r,e);if(-1===t)return;return this.values[t]}var o=e[this.name];if(o&&o[0]===e)return o[1]},e.prototype.delete=function(e){if(!e)throw new Error("WeakMap expected key");var n=this.weakmap;if(n)try{n.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var r=e[this.name];r&&r[0]===e&&(r[0]=r[1]=void 0)}else{this._cleanupClosedWindows();var t=this.keys,o=(0,i.safeIndexOf)(t,e);-1!==o&&(t.splice(o,1),this.values.splice(o,1))}},e.prototype.has=function(e){if(!e)throw new Error("WeakMap expected key");var n=this.weakmap;if(n)try{return n.has(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var r=e[this.name];return!(!r||r[0]!==e)}return this._cleanupClosedWindows(),-1!==(0,i.safeIndexOf)(this.keys,e)},e}()},"./node_modules/cross-domain-utils/src/index.js":function(e,n,r){n.__esModule=!0;var t=r("./node_modules/cross-domain-utils/src/utils.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./node_modules/cross-domain-utils/src/types.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},"./node_modules/cross-domain-utils/src/types.js":function(e,n,r){},"./node_modules/cross-domain-utils/src/util.js":function(e,n,r){n.__esModule=!0,n.isRegex=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.noop=function(){}},"./node_modules/cross-domain-utils/src/utils.js":function(e,n,r){n.__esModule=!0,n.isFileProtocol=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===o.FILE_PROTOCOL},n.isAboutProtocol=s,n.getParent=a,n.getOpener=c,n.canReadFromWindow=u,n.getActualDomain=l,n.getDomain=d,n.isBlankDomain=function(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1},n.isActuallySameDomain=f,n.isSameDomain=p,n.getParents=m,n.isAncestorParent=h,n.getFrames=y,n.getAllChildFrames=v,n.getTop=_,n.getAllFramesInWindow=g,n.isTop=function(e){return e===_(e)},n.isFrameWindowClosed=w,n.isWindowClosed=O,n.linkFrameWindow=function(e){if(function(){for(var e=0;e<S.length;e++)w(S[e])&&(S.splice(e,1),b.splice(e,1));for(var n=0;n<b.length;n++)O(b[n])&&(S.splice(n,1),b.splice(n,1))}(),e&&e.contentWindow)try{b.push(e.contentWindow),S.push(e)}catch(e){}},n.getUserAgent=function(e){return(e=e||window).navigator.mockUserAgent||e.navigator.userAgent},n.getFrameByName=E,n.findChildFrameByName=T,n.findFrameByName=function(e,n){var r;return(r=E(e,n))?r:T(_(e)||e,n)},n.isParent=function(e,n){var r=a(n);if(r)return r===e;var t=y(e),o=Array.isArray(t),i=0;for(t=o?t:t[Symbol.iterator]();;){var s;if(o){if(i>=t.length)break;s=t[i++]}else{if((i=t.next()).done)break;s=i.value}if(s===n)return!0}return!1},n.isOpener=function(e,n){return e===c(n)},n.getAncestor=P,n.getAncestors=function(e){for(var n=[],r=e;r;)(r=P(r))&&n.push(r);return n},n.isAncestor=function(e,n){var r=P(n);if(r)return r===e;if(n===e)return!1;if(_(n)===n)return!1;var t=y(e),o=Array.isArray(t),i=0;for(t=o?t:t[Symbol.iterator]();;){var s;if(o){if(i>=t.length)break;s=t[i++]}else{if((i=t.next()).done)break;s=i.value}if(s===n)return!0}return!1},n.isPopup=A,n.isIframe=j,n.isFullpage=function(){return Boolean(!j()&&!A())},n.getDistanceFromTop=C,n.getNthParent=L,n.getNthParentFromTop=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return L(e,C(e)-n)},n.isSameTopWindow=function(e,n){var r=_(e)||e,t=_(n)||n;try{if(r&&t)return r===t}catch(e){}var o=g(e),i=g(n);if(N(o,i))return!0;var s=c(r),a=c(t);return(!s||!N(g(s),i))&&(a&&N(g(a),o),!1)},n.matchDomain=function e(n,r){if("string"==typeof n){if("string"==typeof r)return n===o.WILDCARD||r===n;if((0,t.isRegex)(r))return!1;if(Array.isArray(r))return!1}return(0,t.isRegex)(n)?(0,t.isRegex)(r)?n.toString()===r.toString():!Array.isArray(r)&&Boolean(r.match(n)):!!Array.isArray(n)&&(Array.isArray(r)?JSON.stringify(n)===JSON.stringify(r):!(0,t.isRegex)(r)&&n.some(function(n){return e(n,r)}))},n.stringifyDomainPattern=function(e){return Array.isArray(e)?"("+e.join(" | ")+")":(0,t.isRegex)(e)?"RegExp("+e.toString():e.toString()},n.getDomainFromUrl=function(e){return e.match(/^(https?|mock|file):\/\//)?e.split("/").slice(0,3).join("/"):d()},n.onCloseWindow=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,o=void 0;return function i(){if(O(e))return o&&clearTimeout(o),n();t<=0?clearTimeout(o):(t-=r,o=setTimeout(i,r))}(),{cancel:function(){o&&clearTimeout(o)}}},n.isWindow=function(e){try{if(e===window)return!0}catch(e){if(e&&e.message===i)return!0}try{if("[object Window]"===Object.prototype.toString.call(e))return!0}catch(e){if(e&&e.message===i)return!0}try{if(window.Window&&e instanceof window.Window)return!0}catch(e){if(e&&e.message===i)return!0}try{if(e&&e.self===e)return!0}catch(e){if(e&&e.message===i)return!0}try{if(e&&e.parent===e)return!0}catch(e){if(e&&e.message===i)return!0}try{if(e&&e.top===e)return!0}catch(e){if(e&&e.message===i)return!0}try{(0,t.noop)(e==e)}catch(e){return!0}try{(0,t.noop)(e&&e.__cross_domain_utils_window_check__)}catch(e){return!0}return!1};var t=r("./node_modules/cross-domain-utils/src/util.js"),o={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",ABOUT_PROTOCOL:"about:",WILDCARD:"*"},i="Call was rejected by callee.\r\n";function s(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===o.ABOUT_PROTOCOL}function a(e){if(e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){}}function c(e){if(e&&!a(e))try{return e.opener}catch(e){}}function u(e){try{return(0,t.noop)(e&&e.location&&e.location.href),!0}catch(e){}return!1}function l(e){var n=e.location;if(!n)throw new Error("Can not read window location");var r=n.protocol;if(!r)throw new Error("Can not read window protocol");if(r===o.FILE_PROTOCOL)return o.FILE_PROTOCOL+"//";if(r===o.ABOUT_PROTOCOL){var t=a(e);return t&&u(t)?l(t):o.ABOUT_PROTOCOL+"//"}var i=n.host;if(!i)throw new Error("Can not read window host");return r+"//"+i}function d(e){var n=l(e=e||window);return n&&e.mockDomain&&0===e.mockDomain.indexOf(o.MOCK_PROTOCOL)?e.mockDomain:n}function f(e){try{if(e===window)return!0}catch(e){}try{var n=Object.getOwnPropertyDescriptor(e,"location");if(n&&!1===n.enumerable)return!1}catch(e){}try{if(s(e)&&u(e))return!0}catch(e){}try{if(l(e)===l(window))return!0}catch(e){}return!1}function p(e){if(!f(e))return!1;try{if(e===window)return!0;if(s(e)&&u(e))return!0;if(d(window)===d(e))return!0}catch(e){}return!1}function m(e){var n=[];try{for(;e.parent!==e;)n.push(e.parent),e=e.parent}catch(e){}return n}function h(e,n){if(!e||!n)return!1;var r=a(n);return r?r===e:-1!==m(n).indexOf(e)}function y(e){var n=[],r=void 0;try{r=e.frames}catch(n){r=e}var t=void 0;try{t=r.length}catch(e){}if(0===t)return n;if(t){for(var o=0;o<t;o++){var i=void 0;try{i=r[o]}catch(e){continue}n.push(i)}return n}for(var s=0;s<100;s++){var a=void 0;try{a=r[s]}catch(e){return n}if(!a)return n;n.push(a)}return n}function v(e){var n=[],r=y(e),t=Array.isArray(r),o=0;for(r=t?r:r[Symbol.iterator]();;){var i;if(t){if(o>=r.length)break;i=r[o++]}else{if((o=r.next()).done)break;i=o.value}var s=i;n.push(s);var a=v(s),c=Array.isArray(a),u=0;for(a=c?a:a[Symbol.iterator]();;){var l;if(c){if(u>=a.length)break;l=a[u++]}else{if((u=a.next()).done)break;l=u.value}var d=l;n.push(d)}}return n}function _(e){if(e){try{if(e.top)return e.top}catch(e){}if(a(e)===e)return e;try{if(h(window,e)&&window.top)return window.top}catch(e){}try{if(h(e,window)&&window.top)return window.top}catch(e){}var n=v(e),r=Array.isArray(n),t=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(t>=n.length)break;o=n[t++]}else{if((t=n.next()).done)break;o=t.value}var i=o;try{if(i.top)return i.top}catch(e){}if(a(i)===i)return i}}}function g(e){var n=_(e);return v(n).concat(n)}function w(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var n=e.ownerDocument;return!(!n||!n.body||n.body.contains(e))}var b=[],S=[];function O(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==i}if(n&&p(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{(0,t.noop)(e==e)}catch(e){return!0}var r=function(e,n){for(var r=0;r<e.length;r++)try{if(e[r]===n)return r}catch(e){}return-1}(b,e);if(-1!==r){var o=S[r];if(o&&w(o))return!0}return!1}function E(e,n){var r=y(e),t=r,o=Array.isArray(t),i=0;for(t=o?t:t[Symbol.iterator]();;){var s;if(o){if(i>=t.length)break;s=t[i++]}else{if((i=t.next()).done)break;s=i.value}var a=s;try{if(p(a)&&a.name===n&&-1!==r.indexOf(a))return a}catch(e){}}try{if(-1!==r.indexOf(e.frames[n]))return e.frames[n]}catch(e){}try{if(-1!==r.indexOf(e[n]))return e[n]}catch(e){}}function T(e,n){var r=E(e,n);if(r)return r;var t=y(e),o=Array.isArray(t),i=0;for(t=o?t:t[Symbol.iterator]();;){var s;if(o){if(i>=t.length)break;s=t[i++]}else{if((i=t.next()).done)break;s=i.value}var a=T(s,n);if(a)return a}}function P(e){var n=c(e=e||window);return n||(a(e)||void 0)}function A(){return Boolean(c(window))}function j(){return Boolean(a(window))}function N(e,n){var r=e,t=Array.isArray(r),o=0;for(r=t?r:r[Symbol.iterator]();;){var i;if(t){if(o>=r.length)break;i=r[o++]}else{if((o=r.next()).done)break;i=o.value}var s=i,a=n,c=Array.isArray(a),u=0;for(a=c?a:a[Symbol.iterator]();;){var l;if(c){if(u>=a.length)break;l=a[u++]}else{if((u=a.next()).done)break;l=u.value}if(s===l)return!0}}return!1}function C(){for(var e=0,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;n;)(n=a(n))&&(e+=1);return e}function L(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e,t=0;t<n;t++){if(!r)return;r=a(r)}return r}},"./node_modules/webpack/buildin/global.js":function(e,n,r){var t,o="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)};t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(t=window)}e.exports=t},"./node_modules/zalgo-promise/src/exceptions.js":function(e,n,r){n.__esModule=!0,n.dispatchPossiblyUnhandledError=function(e){if(-1===(0,t.getGlobal)().dispatchedErrors.indexOf(e)){(0,t.getGlobal)().dispatchedErrors.push(e),setTimeout(function(){throw e},1);for(var n=0;n<(0,t.getGlobal)().possiblyUnhandledPromiseHandlers.length;n++)(0,t.getGlobal)().possiblyUnhandledPromiseHandlers[n](e)}},n.onPossiblyUnhandledException=function(e){return(0,t.getGlobal)().possiblyUnhandledPromiseHandlers.push(e),{cancel:function(){(0,t.getGlobal)().possiblyUnhandledPromiseHandlers.splice((0,t.getGlobal)().possiblyUnhandledPromiseHandlers.indexOf(e),1)}}};var t=r("./node_modules/zalgo-promise/src/global.js")},"./node_modules/zalgo-promise/src/global.js":function(e,n,r){(function(e){n.__esModule=!0,n.getGlobal=function(){var n=void 0;if("undefined"!=typeof window)n=window;else{if(void 0===e)throw new TypeError("Can not find global");n=e}var r=n.__zalgopromise__=n.__zalgopromise__||{};return r.flushPromises=r.flushPromises||[],r.activeCount=r.activeCount||0,r.possiblyUnhandledPromiseHandlers=r.possiblyUnhandledPromiseHandlers||[],r.dispatchedErrors=r.dispatchedErrors||[],r}}).call(n,r("./node_modules/webpack/buildin/global.js"))},"./node_modules/zalgo-promise/src/index.js":function(e,n,r){n.__esModule=!0;var t=r("./node_modules/zalgo-promise/src/promise.js");Object.defineProperty(n,"ZalgoPromise",{enumerable:!0,get:function(){return t.ZalgoPromise}})},"./node_modules/zalgo-promise/src/promise.js":function(e,n,r){n.__esModule=!0,n.ZalgoPromise=void 0;var t=r("./node_modules/zalgo-promise/src/utils.js"),o=r("./node_modules/zalgo-promise/src/exceptions.js"),i=r("./node_modules/zalgo-promise/src/global.js"),s=function(){function e(n){var r=this;if(function(n,r){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],n){var t=void 0,o=void 0,i=!1,s=!1,a=!1;try{n(function(e){a?r.resolve(e):(i=!0,t=e)},function(e){a?r.reject(e):(s=!0,o=e)})}catch(e){return void this.reject(e)}a=!0,i?this.resolve(t):s&&this.reject(o)}}return e.prototype.resolve=function(e){if(this.resolved||this.rejected)return this;if((0,t.isPromise)(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this},e.prototype.reject=function(e){var n=this;if(this.resolved||this.rejected)return this;if((0,t.isPromise)(e))throw new Error("Can not reject promise with another promise");if(!e){var r=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+r)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){n.errorHandled||(0,o.dispatchPossiblyUnhandledError)(e)},1),this.dispatch(),this},e.prototype.asyncReject=function(e){this.errorHandled=!0,this.reject(e)},e.prototype.dispatch=function(){var n=this,r=this.dispatching,o=this.resolved,s=this.rejected,a=this.handlers;if(!r&&(o||s)){this.dispatching=!0,(0,i.getGlobal)().activeCount+=1;for(var c=function(r){var i=a[r],c=i.onSuccess,u=i.onError,l=i.promise,d=void 0;if(o)try{d=c?c(n.value):n.value}catch(e){return l.reject(e),"continue"}else if(s){if(!u)return l.reject(n.error),"continue";try{d=u(n.error)}catch(e){return l.reject(e),"continue"}}d instanceof e&&(d.resolved||d.rejected)?(d.resolved?l.resolve(d.value):l.reject(d.error),d.errorHandled=!0):(0,t.isPromise)(d)?d instanceof e&&(d.resolved||d.rejected)?d.resolved?l.resolve(d.value):l.reject(d.error):d.then(function(e){l.resolve(e)},function(e){l.reject(e)}):l.resolve(d)},u=0;u<a.length;u++)c(u);a.length=0,this.dispatching=!1,(0,i.getGlobal)().activeCount-=1,0===(0,i.getGlobal)().activeCount&&e.flushQueue()}},e.prototype.then=function(n,r){if(n&&"function"!=typeof n&&!n.call)throw new Error("Promise.then expected a function for success handler");if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for error handler");var t=new e;return this.handlers.push({promise:t,onSuccess:n,onError:r}),this.errorHandled=!0,this.dispatch(),t},e.prototype.catch=function(e){return this.then(void 0,e)},e.prototype.finally=function(n){return this.then(function(r){return e.try(n).then(function(){return r})},function(r){return e.try(n).then(function(){throw r})})},e.prototype.timeout=function(e,n){var r=this;if(this.resolved||this.rejected)return this;var t=setTimeout(function(){r.resolved||r.rejected||r.reject(n||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(t),e})},e.prototype.toPromise=function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)},e.resolve=function(n){return n instanceof e?n:(0,t.isPromise)(n)?new e(function(e,r){return n.then(e,r)}):(new e).resolve(n)},e.reject=function(n){return(new e).reject(n)},e.all=function(n){var r=new e,o=n.length,i=[];if(!o)return r.resolve(i),r;for(var s=function(s){var a=n[s];if(a instanceof e){if(a.resolved)return i[s]=a.value,o-=1,"continue"}else if(!(0,t.isPromise)(a))return i[s]=a,o-=1,"continue";e.resolve(a).then(function(e){i[s]=e,0==(o-=1)&&r.resolve(i)},function(e){r.reject(e)})},a=0;a<n.length;a++)s(a);return 0===o&&r.resolve(i),r},e.hash=function(n){var r={};return e.all(Object.keys(n).map(function(t){return e.resolve(n[t]).then(function(e){r[t]=e})})).then(function(){return r})},e.map=function(n,r){return e.all(n.map(r))},e.onPossiblyUnhandledException=function(e){return(0,o.onPossiblyUnhandledException)(e)},e.try=function(n,r,t){var o=void 0;try{o=n.apply(r,t||[])}catch(n){return e.reject(n)}return e.resolve(o)},e.delay=function(n){return new e(function(e){setTimeout(e,n)})},e.isPromise=function(n){return!!(n&&n instanceof e)||(0,t.isPromise)(n)},e.flush=function(){var n=new e;return(0,i.getGlobal)().flushPromises.push(n),0===(0,i.getGlobal)().activeCount&&e.flushQueue(),n},e.flushQueue=function(){var e=(0,i.getGlobal)().flushPromises;(0,i.getGlobal)().flushPromises=[];var n=e,r=Array.isArray(n),t=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(t>=n.length)break;o=n[t++]}else{if((t=n.next()).done)break;o=t.value}o.resolve()}},e}();n.ZalgoPromise=s},"./node_modules/zalgo-promise/src/utils.js":function(e,n,r){n.__esModule=!0,n.isPromise=function(e){try{if(!e)return!1;if("undefined"!=typeof Promise&&e instanceof Promise)return!0;if("undefined"!=typeof window&&window.Window&&e instanceof window.Window)return!1;if("undefined"!=typeof window&&window.constructor&&e instanceof window.constructor)return!1;var n={}.toString;if(n){var r=n.call(e);if("[object Window]"===r||"[object global]"===r||"[object DOMWindow]"===r)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}},"./src/clean.js":function(e,n,r){n.__esModule=!0,n.cleanUpWindow=function(e){var n=t.global.requestPromises.get(e);if(n){var r=n,o=Array.isArray(r),i=0;for(r=o?r:r[Symbol.iterator]();;){var s;if(o){if(i>=r.length)break;s=r[i++]}else{if((i=r.next()).done)break;s=i.value}s.reject(new Error("No response from window - cleaned up"))}}t.global.popupWindowsByWin&&t.global.popupWindowsByWin.delete(e),t.global.remoteWindows&&t.global.remoteWindows.delete(e),t.global.requestPromises.delete(e),t.global.methods.delete(e),t.global.readyPromises.delete(e)},r("./node_modules/cross-domain-utils/src/index.js");var t=r("./src/global.js")},"./src/conf/config.js":function(e,n,r){n.__esModule=!0,n.CONFIG=void 0;var t,o=r("./src/conf/constants.js"),i=n.CONFIG={ALLOW_POSTMESSAGE_POPUP:!("__ALLOW_POSTMESSAGE_POPUP__"in window)||window.__ALLOW_POSTMESSAGE_POPUP__,LOG_LEVEL:"info",BRIDGE_TIMEOUT:5e3,CHILD_WINDOW_TIMEOUT:5e3,ACK_TIMEOUT:-1!==window.navigator.userAgent.match(/MSIE/i)?2e3:1e3,RES_TIMEOUT:-1,LOG_TO_PAGE:!1,ALLOWED_POST_MESSAGE_METHODS:(t={},t[o.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE]=!0,t[o.CONSTANTS.SEND_STRATEGIES.BRIDGE]=!0,t[o.CONSTANTS.SEND_STRATEGIES.GLOBAL]=!0,t),ALLOW_SAME_ORIGIN:!1};0===window.location.href.indexOf(o.CONSTANTS.FILE_PROTOCOL)&&(i.ALLOW_POSTMESSAGE_POPUP=!0)},"./src/conf/constants.js":function(e,n,r){n.__esModule=!0,n.CONSTANTS={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",HELLO:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",ABOUT_PROTOCOL:"about:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"};var t=n.POST_MESSAGE_NAMES={METHOD:"postrobot_method",HELLO:"postrobot_hello",OPEN_TUNNEL:"postrobot_open_tunnel"};n.POST_MESSAGE_NAMES_LIST=Object.keys(t).map(function(e){return t[e]})},"./src/conf/index.js":function(e,n,r){n.__esModule=!0;var t=r("./src/conf/config.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./src/conf/constants.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})})},"./src/drivers/index.js":function(e,n,r){n.__esModule=!0;var t=r("./src/drivers/receive/index.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./src/drivers/send/index.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=r("./src/drivers/listeners.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})})},"./src/drivers/listeners.js":function(e,n,r){n.__esModule=!0,n.resetListeners=function(){i.global.responseListeners={},i.global.requestListeners={}},n.addResponseListener=function(e,n){i.global.responseListeners[e]=n},n.getResponseListener=function(e){return i.global.responseListeners[e]},n.deleteResponseListener=function(e){delete i.global.responseListeners[e]},n.markResponseListenerErrored=function(e){i.global.erroredResponseListeners[e]=!0},n.isResponseListenerErrored=function(e){return Boolean(i.global.erroredResponseListeners[e])},n.getRequestListener=u,n.addRequestListener=function e(n,r){var o=n.name,l=n.win,d=n.domain;if(!o||"string"!=typeof o)throw new Error("Name required to add request listener");if(Array.isArray(l)){var f=[],p=l,m=Array.isArray(p),h=0;for(p=m?p:p[Symbol.iterator]();;){var y;if(m){if(h>=p.length)break;y=p[h++]}else{if((h=p.next()).done)break;y=h.value}var v=y;f.push(e({name:o,domain:d,win:v},r))}return{cancel:function(){var e=f,n=Array.isArray(e),r=0;for(e=n?e:e[Symbol.iterator]();;){var t;if(n){if(r>=e.length)break;t=e[r++]}else{if((r=e.next()).done)break;t=r.value}t.cancel()}}}}if(Array.isArray(d)){var _=[],g=d,w=Array.isArray(g),b=0;for(g=w?g:g[Symbol.iterator]();;){var S;if(w){if(b>=g.length)break;S=g[b++]}else{if((b=g.next()).done)break;S=b.value}var O=S;_.push(e({name:o,win:l,domain:O},r))}return{cancel:function(){var e=_,n=Array.isArray(e),r=0;for(e=n?e:e[Symbol.iterator]();;){var t;if(n){if(r>=e.length)break;t=e[r++]}else{if((r=e.next()).done)break;t=r.value}t.cancel()}}}}var E=u({name:o,win:l,domain:d});if(l&&l!==a.CONSTANTS.WILDCARD||(l=i.global.WINDOW_WILDCARD),d=d||a.CONSTANTS.WILDCARD,E)throw l&&d?new Error("Request listener already exists for "+o+" on domain "+d.toString()+" for "+(l===i.global.WINDOW_WILDCARD?"wildcard":"specified")+" window"):l?new Error("Request listener already exists for "+o+" for "+(l===i.global.WINDOW_WILDCARD?"wildcard":"specified")+" window"):d?new Error("Request listener already exists for "+o+" on domain "+d.toString()):new Error("Request listener already exists for "+o);var T=i.global.requestListeners,P=T[o];P||(P=new t.WeakMap,T[o]=P);var A=P.get(l);A||(A={},P.set(l,A));var j=d.toString(),N=A[c],C=void 0;return(0,s.isRegex)(d)?(N||(N=[],A[c]=N),C={regex:d,listener:r},N.push(C)):A[j]=r,{cancel:function(){A&&(delete A[j],l&&0===Object.keys(A).length&&P.delete(l),C&&N.splice(N.indexOf(C,1)))}}},r("./node_modules/zalgo-promise/src/index.js");var t=r("./node_modules/cross-domain-safe-weakmap/src/index.js"),o=r("./node_modules/cross-domain-utils/src/index.js"),i=r("./src/global.js"),s=r("./src/lib/index.js"),a=r("./src/conf/index.js");i.global.responseListeners=i.global.responseListeners||{},i.global.requestListeners=i.global.requestListeners||{},i.global.WINDOW_WILDCARD=i.global.WINDOW_WILDCARD||new function(){},i.global.erroredResponseListeners=i.global.erroredResponseListeners||{};var c="__domain_regex__";function u(e){var n=e.name,r=e.win,t=e.domain;if(r===a.CONSTANTS.WILDCARD&&(r=null),t===a.CONSTANTS.WILDCARD&&(t=null),!n)throw new Error("Name required to get request listener");var s=i.global.requestListeners[n];if(s)for(var u=[r,i.global.WINDOW_WILDCARD],l=0;l<u.length;l++){var d=u[l],f=d&&s.get(d);if(f){if(t&&"string"==typeof t){if(f[t])return f[t];if(f[c]){var p=f[c],m=Array.isArray(p),h=0;for(p=m?p:p[Symbol.iterator]();;){var y;if(m){if(h>=p.length)break;y=p[h++]}else{if((h=p.next()).done)break;y=h.value}var v=y,_=v.regex,g=v.listener;if((0,o.matchDomain)(_,t))return g}}}if(f[a.CONSTANTS.WILDCARD])return f[a.CONSTANTS.WILDCARD]}}}},"./src/drivers/receive/index.js":function(e,n,r){n.__esModule=!0;var t="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)};n.receiveMessage=l,n.messageListener=d,n.listenForMessages=function(){(0,a.addEventListener)(window,"message",d)};var o=r("./node_modules/cross-domain-utils/src/index.js"),s=r("./src/conf/index.js"),a=r("./src/lib/index.js"),c=r("./src/global.js"),u=r("./src/drivers/receive/types.js");function l(e){if(!window||window.closed)throw new Error("Message recieved in closed window");try{if(!e.source)return}catch(e){return}var n=e.source,r=e.origin,i=function(e){var n=void 0;try{n=(0,a.jsonParse)(e)}catch(e){return}if(n&&"object"===(void 0===n?"undefined":t(n))&&null!==n&&(n=n[s.CONSTANTS.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===n?"undefined":t(n))&&null!==n&&n.type&&"string"==typeof n.type&&u.RECEIVE_MESSAGE_TYPES[n.type])return n}(e.data);if(i){if(!i.sourceDomain||"string"!=typeof i.sourceDomain)throw new Error("Expected message to have sourceDomain");if(0!==i.sourceDomain.indexOf(s.CONSTANTS.MOCK_PROTOCOL)&&0!==i.sourceDomain.indexOf(s.CONSTANTS.FILE_PROTOCOL)||(r=i.sourceDomain),0===i.sourceDomain.indexOf(s.CONSTANTS.ABOUT_PROTOCOL)&&(r="*"),-1===c.global.receivedMessages.indexOf(i.id)){c.global.receivedMessages.push(i.id);var l;l=-1!==s.POST_MESSAGE_NAMES_LIST.indexOf(i.name)||i.type===s.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===i.ack?"error":"info",a.log.logLevel(l,["\n\n\t","#receive",i.type.replace(/^postrobot_message_/,""),"::",i.name,"::",r,"\n\n",i]),!(0,o.isWindowClosed)(n)||i.fireAndForget?(i.data&&(i.data=(0,a.deserializeMethods)(n,r,i.data)),u.RECEIVE_MESSAGE_TYPES[i.type](n,r,i)):a.log.debug("Source window is closed - can not send "+i.type+" "+i.name)}}}function d(e){try{(0,a.noop)(e.source)}catch(e){return}l({source:e.source||e.sourceElement,origin:e.origin||e.originalEvent&&e.originalEvent.origin,data:e.data})}c.global.receivedMessages=c.global.receivedMessages||[],c.global.receiveMessage=l},"./src/drivers/receive/types.js":function(e,n,r){n.__esModule=!0,n.RECEIVE_MESSAGE_TYPES=void 0;var t,o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},i=r("./node_modules/zalgo-promise/src/index.js"),s=r("./node_modules/cross-domain-utils/src/index.js"),a=r("./src/conf/index.js"),c=r("./src/lib/index.js"),u=r("./src/drivers/send/index.js"),l=r("./src/drivers/listeners.js");n.RECEIVE_MESSAGE_TYPES=((t={})[a.CONSTANTS.POST_MESSAGE_TYPE.ACK]=function(e,n,r){if(!(0,l.isResponseListenerErrored)(r.hash)){var t=(0,l.getResponseListener)(r.hash);if(!t)throw new Error("No handler found for post message ack for message: "+r.name+" from "+n+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(t.domain,n))throw new Error("Ack origin "+n+" does not match domain "+t.domain.toString());t.ack=!0}},t[a.CONSTANTS.POST_MESSAGE_TYPE.REQUEST]=function(e,n,r){var t=(0,l.getRequestListener)({name:r.name,win:e,domain:n});function d(t){return r.fireAndForget||(0,s.isWindowClosed)(e)?i.ZalgoPromise.resolve():(0,u.sendMessage)(e,o({target:r.originalSource,hash:r.hash,name:r.name},t),n)}return i.ZalgoPromise.all([d({type:a.CONSTANTS.POST_MESSAGE_TYPE.ACK}),i.ZalgoPromise.try(function(){if(!t)throw new Error("No handler found for post message: "+r.name+" from "+n+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(t.domain,n))throw new Error("Request origin "+n+" does not match domain "+t.domain.toString());var o=r.data;return t.handler({source:e,origin:n,data:o})}).then(function(e){return d({type:a.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:a.CONSTANTS.POST_MESSAGE_ACK.SUCCESS,data:e})},function(e){var n=(0,c.stringifyError)(e).replace(/^Error: /,""),r=e.code;return d({type:a.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:a.CONSTANTS.POST_MESSAGE_ACK.ERROR,error:n,code:r})})]).then(c.noop).catch(function(e){if(t&&t.handleError)return t.handleError(e);c.log.error((0,c.stringifyError)(e))})},t[a.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE]=function(e,n,r){if(!(0,l.isResponseListenerErrored)(r.hash)){var t=(0,l.getResponseListener)(r.hash);if(!t)throw new Error("No handler found for post message response for message: "+r.name+" from "+n+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(t.domain,n))throw new Error("Response origin "+n+" does not match domain "+(0,s.stringifyDomainPattern)(t.domain));if((0,l.deleteResponseListener)(r.hash),r.ack===a.CONSTANTS.POST_MESSAGE_ACK.ERROR){var o=new Error(r.error);return r.code&&(o.code=r.code),t.respond(o,null)}if(r.ack===a.CONSTANTS.POST_MESSAGE_ACK.SUCCESS){var i=r.data||r.response;return t.respond(null,{source:e,origin:n,data:i})}}},t)},"./src/drivers/send/index.js":function(e,n,r){n.__esModule=!0;var t=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e};n.sendMessage=function(e,n,r){return i.ZalgoPromise.try(function(){var u;n=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(0,a.uniqueID)(),s=(0,a.getWindowType)(),c=(0,o.getDomain)(window);return t({},n,r,{sourceDomain:c,id:n.id||i,windowType:s})}(e,n,{data:(0,a.serializeMethods)(e,r,n.data),domain:r});var l;if(l=-1!==s.POST_MESSAGE_NAMES_LIST.indexOf(n.name)||n.type===s.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===n.ack?"error":"info",a.log.logLevel(l,["\n\n\t","#send",n.type.replace(/^postrobot_message_/,""),"::",n.name,"::",r||s.CONSTANTS.WILDCARD,"\n\n",n]),e===window&&!s.CONFIG.ALLOW_SAME_ORIGIN)throw new Error("Attemping to send message to self");if((0,o.isWindowClosed)(e))throw new Error("Window is closed");a.log.debug("Running send message strategies",n);var d=[],f=(0,a.jsonStringify)(((u={})[s.CONSTANTS.WINDOW_PROPS.POSTROBOT]=n,u),null,2);return i.ZalgoPromise.map(Object.keys(c.SEND_MESSAGE_STRATEGIES),function(n){return i.ZalgoPromise.try(function(){if(!s.CONFIG.ALLOWED_POST_MESSAGE_METHODS[n])throw new Error("Strategy disallowed: "+n);return c.SEND_MESSAGE_STRATEGIES[n](e,f,r)}).then(function(){return d.push(n+": success"),!0},function(e){return d.push(n+": "+(0,a.stringifyError)(e)+"\n"),!1})}).then(function(e){var r=e.some(Boolean),t=n.type+" "+n.name+" "+(r?"success":"error")+":\n  - "+d.join("\n  - ")+"\n";if(a.log.debug(t),!r)throw new Error(t)})})};var o=r("./node_modules/cross-domain-utils/src/index.js"),i=r("./node_modules/zalgo-promise/src/index.js"),s=r("./src/conf/index.js"),a=r("./src/lib/index.js"),c=r("./src/drivers/send/strategies.js")},"./src/drivers/send/strategies.js":function(e,n,r){n.__esModule=!0,n.SEND_MESSAGE_STRATEGIES=void 0;var t=r("./node_modules/cross-domain-utils/src/index.js"),o=r("./src/conf/index.js");(n.SEND_MESSAGE_STRATEGIES={})[o.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE]=function(e,n,r){(Array.isArray(r)?r:"string"==typeof r?[r]:[o.CONSTANTS.WILDCARD]).map(function(n){if(0===n.indexOf(o.CONSTANTS.MOCK_PROTOCOL)){if(window.location.protocol===o.CONSTANTS.FILE_PROTOCOL)return o.CONSTANTS.WILDCARD;if(!(0,t.isActuallySameDomain)(e))throw new Error("Attempting to send messsage to mock domain "+n+", but window is actually cross-domain");return(0,t.getActualDomain)(e)}return 0===n.indexOf(o.CONSTANTS.FILE_PROTOCOL)?o.CONSTANTS.WILDCARD:n}).forEach(function(r){return e.postMessage(n,"null"===r?"*":r)})}},"./src/global.js":function(e,n,r){n.__esModule=!0,n.global=void 0;var t=r("./src/conf/index.js");(n.global=window[t.CONSTANTS.WINDOW_PROPS.POSTROBOT]=window[t.CONSTANTS.WINDOW_PROPS.POSTROBOT]||{}).registerSelf=function(){}},"./src/index.js":function(e,n,r){n.__esModule=!0;var t=r("./src/interface.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=function(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n.default=e,n}(t);n.default=o},"./src/interface.js":function(e,n,r){n.__esModule=!0,n.bridge=n.Promise=n.cleanUpWindow=void 0;var t=r("./src/public/index.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./src/clean.js");Object.defineProperty(n,"cleanUpWindow",{enumerable:!0,get:function(){return o.cleanUpWindow}});var i=r("./node_modules/zalgo-promise/src/index.js");Object.defineProperty(n,"Promise",{enumerable:!0,get:function(){return i.ZalgoPromise}}),n.init=u;var s=r("./src/lib/index.js"),a=r("./src/drivers/index.js"),c=r("./src/global.js");function u(){c.global.initialized||((0,a.listenForMessages)(),(0,s.initOnReady)(),(0,s.listenForMethods)({on:t.on,send:t.send})),c.global.initialized=!0}n.bridge=null,u()},"./src/lib/index.js":function(e,n,r){n.__esModule=!0;var t=r("./src/lib/util.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./src/lib/log.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=r("./src/lib/serialize.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var s=r("./src/lib/ready.js");Object.keys(s).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return s[e]}})})},"./src/lib/log.js":function(e,n,r){n.__esModule=!0,n.log=void 0;var t="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)},o=r("./src/conf/index.js"),s=r("./src/lib/util.js"),a=["debug","info","warn","error"];Function.prototype.bind&&window.console&&"object"===t(console.log)&&["log","info","warn","error"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call);var c=n.log={clearLogs:function(){if(window.console&&window.console.clear&&window.console.clear(),o.CONFIG.LOG_TO_PAGE){var e=document.getElementById("postRobotLogs");e&&e.parentNode&&e.parentNode.removeChild(e)}},writeToPage:function(e,n){setTimeout(function(){var r=document.getElementById("postRobotLogs");r||((r=document.createElement("div")).id="postRobotLogs",r.style.cssText="width: 800px; font-family: monospace; white-space: pre-wrap;",document.body&&document.body.appendChild(r));var t=document.createElement("div"),o=(new Date).toString().split(" ")[4],i=Array.prototype.slice.call(n).map(function(e){if("string"==typeof e)return e;if(!e)return Object.prototype.toString.call(e);var n=void 0;try{n=(0,s.jsonStringify)(e,null,2)}catch(e){n="[object]"}return"\n\n"+n+"\n\n"}).join(" "),a=o+" "+e+" "+i;t.innerHTML=a;var c={log:"#ddd",warn:"orange",error:"red",info:"blue",debug:"#aaa"}[e];t.style.cssText="margin-top: 10px; color: "+c+";",r.childNodes.length?r.insertBefore(t,r.childNodes[0]):r.appendChild(t)})},logLevel:function(e,n){setTimeout(function(){try{var r=window.LOG_LEVEL||o.CONFIG.LOG_LEVEL;if("disabled"===r||a.indexOf(e)<a.indexOf(r))return;if((n=Array.prototype.slice.call(n)).unshift(""+window.location.host+window.location.pathname),n.unshift("::"),n.unshift(""+(0,s.getWindowType)().toLowerCase()),n.unshift("[post-robot]"),o.CONFIG.LOG_TO_PAGE&&c.writeToPage(e,n),!window.console)return;if(window.console[e]||(e="log"),!window.console[e])return;window.console[e].apply(window.console,n)}catch(e){}},1)},debug:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];c.logLevel("debug",n)},info:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];c.logLevel("info",n)},warn:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];c.logLevel("warn",n)},error:function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];c.logLevel("error",n)}}},"./src/lib/ready.js":function(e,n,r){n.__esModule=!0,n.onHello=l,n.sayHello=d,n.initOnReady=function(){l(function(e){var n=e.source,r=e.origin,t=a.global.readyPromises.get(n)||new i.ZalgoPromise;t.resolve({origin:r}),a.global.readyPromises.set(n,t)});var e=(0,o.getAncestor)();e&&d(e).catch(function(e){c.log.debug((0,u.stringifyError)(e))})},n.onChildWindowReady=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",t=a.global.readyPromises.get(e);return t||(t=new i.ZalgoPromise,a.global.readyPromises.set(e,t),-1!==n&&setTimeout(function(){return t.reject(new Error(r+" did not load after "+n+"ms"))},n),t)};var t=r("./node_modules/cross-domain-safe-weakmap/src/index.js"),o=r("./node_modules/cross-domain-utils/src/index.js"),i=r("./node_modules/zalgo-promise/src/index.js"),s=r("./src/conf/index.js"),a=r("./src/global.js"),c=r("./src/lib/log.js"),u=r("./src/lib/util.js");function l(e){a.global.on(s.CONSTANTS.POST_MESSAGE_NAMES.HELLO,{domain:s.CONSTANTS.WILDCARD},function(n){var r=n.source,t=n.origin;return e({source:r,origin:t})})}function d(e){return a.global.send(e,s.CONSTANTS.POST_MESSAGE_NAMES.HELLO,{},{domain:s.CONSTANTS.WILDCARD,timeout:-1}).then(function(e){return{origin:e.origin}})}a.global.readyPromises=a.global.readyPromises||new t.WeakMap},"./src/lib/serialize.js":function(e,n,r){n.__esModule=!0,n.listenForMethods=void 0;var t="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)};n.serializeMethod=p,n.serializeMethods=function(e,n,r){return(0,l.replaceObject)({obj:r},function(r,t){return"function"==typeof r?p(e,n,r,t.toString()):r instanceof Error?(o=r,{__type__:c.CONSTANTS.SERIALIZATION_TYPES.ERROR,__message__:(0,l.stringifyError)(o),__code__:o.code}):window.Promise&&r instanceof window.Promise?function(e,n,r,t){return{__type__:c.CONSTANTS.SERIALIZATION_TYPES.PROMISE,__then__:p(e,n,function(e,n){return r.then(e,n)},t+".then")}}(e,n,r,t.toString()):a.ZalgoPromise.isPromise(r)?function(e,n,r,t){return{__type__:c.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:p(e,n,function(e,n){return r.then(e,n)},t+".then")}}(e,n,r,t.toString()):(0,l.isRegex)(r)?(i=r,{__type__:c.CONSTANTS.SERIALIZATION_TYPES.REGEX,__source__:i.source}):void 0;var o,i}).obj},n.deserializeMethod=m,n.deserializeError=h,n.deserializeZalgoPromise=y,n.deserializePromise=v,n.deserializeRegex=_,n.deserializeMethods=function(e,n,r){return(0,l.replaceObject)({obj:r},function(r){if("object"===(void 0===r?"undefined":t(r))&&null!==r)return f(r,c.CONSTANTS.SERIALIZATION_TYPES.METHOD)?m(e,n,r):f(r,c.CONSTANTS.SERIALIZATION_TYPES.ERROR)?h(e,n,r):f(r,c.CONSTANTS.SERIALIZATION_TYPES.PROMISE)?v(e,n,r):f(r,c.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE)?y(e,n,r):f(r,c.CONSTANTS.SERIALIZATION_TYPES.REGEX)?_(e,n,r):void 0}).obj};var o=r("./node_modules/cross-domain-safe-weakmap/src/index.js"),s=r("./node_modules/cross-domain-utils/src/index.js"),a=r("./node_modules/zalgo-promise/src/index.js"),c=r("./src/conf/index.js"),u=r("./src/global.js"),l=r("./src/lib/util.js"),d=r("./src/lib/log.js");function f(e,n){return"object"===(void 0===e?"undefined":t(e))&&null!==e&&e.__type__===n}function p(e,n,r,t){var o=(0,l.uniqueID)(),i=u.global.methods.get(e);return i||(i={},u.global.methods.set(e,i)),i[o]={domain:n,method:r},{__type__:c.CONSTANTS.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:t}}function m(e,n,r){function t(){var t=Array.prototype.slice.call(arguments);return d.log.debug("Call foreign method",r.__name__,t),u.global.send(e,c.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{id:r.__id__,name:r.__name__,args:t},{domain:n,timeout:-1}).then(function(e){var n=e.data;return d.log.debug("Got foreign method result",r.__name__,n.result),n.result},function(e){throw d.log.debug("Got foreign method error",(0,l.stringifyError)(e)),e})}return t.__name__=r.__name__,t.__xdomain__=!0,t.source=e,t.origin=n,t}function h(e,n,r){var t=new Error(r.__message__);return r.__code__&&(t.code=r.__code__),t}function y(e,n,r){return new a.ZalgoPromise(function(t,o){return m(e,n,r.__then__)(t,o)})}function v(e,n,r){return window.Promise?new window.Promise(function(t,o){return m(e,n,r.__then__)(t,o)}):y(e,n,r)}function _(e,n,r){return new RegExp(r.__source__)}u.global.methods=u.global.methods||new o.WeakMap,n.listenForMethods=(0,l.once)(function(){u.global.on(c.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{origin:c.CONSTANTS.WILDCARD},function(e){var n=e.source,r=e.origin,t=e.data,o=u.global.methods.get(n);if(!o)throw new Error("Could not find any methods this window has privileges to call");var i=o[t.id];if(!i)throw new Error("Could not find method with id: "+t.id);if(!(0,s.matchDomain)(i.domain,r))throw new Error("Method domain "+i.domain+" does not match origin "+r);return d.log.debug("Call local method",t.name,t.args),a.ZalgoPromise.try(function(){return i.method.apply({source:n,origin:r,data:t},t.args)}).then(function(e){return{result:e,id:t.id,name:t.name}})})})},"./src/lib/util.js":function(e,n,r){n.__esModule=!0,n.weakMapMemoize=n.once=void 0;var t="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)};n.stringifyError=function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(r>=3)return"stringifyError stack overflow";try{if(!n)return"<unknown error: "+Object.prototype.toString.call(n)+">";if("string"==typeof n)return n;if(n instanceof Error){var t=n&&n.stack,o=n&&n.message;if(t&&o)return-1!==t.indexOf(o)?t:o+"\n"+t;if(t)return t;if(o)return o}return"function"==typeof n.toString?n.toString():Object.prototype.toString.call(n)}catch(n){return"Error while stringifying error: "+e(n,r+1)}},n.noop=function(){},n.addEventListener=function(e,n,r){return e.addEventListener?e.addEventListener(n,r):e.attachEvent("on"+n,r),{cancel:function(){e.removeEventListener?e.removeEventListener(n,r):e.detachEvent("on"+n,r)}}},n.uniqueID=function(){var e="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return e.charAt(Math.floor(Math.random()*e.length))})},n.eachArray=c,n.eachObject=u,n.each=l,n.replaceObject=function e(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(o>=100)throw new Error("Self-referential object passed, or object contained too many layers");var i=void 0;if("object"!==(void 0===n?"undefined":t(n))||null===n||Array.isArray(n)){if(!Array.isArray(n))throw new TypeError("Invalid type: "+(void 0===n?"undefined":t(n)));i=[]}else i={};return l(n,function(n,s){var a=r(n,s);void 0!==a?i[s]=a:"object"===(void 0===n?"undefined":t(n))&&null!==n?i[s]=e(n,r,o+1):i[s]=n}),i},n.safeInterval=function(e,n){var r=void 0;return r=setTimeout(function t(){r=setTimeout(t,n),e.call()},n),{cancel:function(){clearTimeout(r)}}},n.isRegex=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.getWindowType=function(){return(0,s.isPopup)()?a.CONSTANTS.WINDOW_TYPES.POPUP:(0,s.isIframe)()?a.CONSTANTS.WINDOW_TYPES.IFRAME:a.CONSTANTS.WINDOW_TYPES.FULLPAGE},n.jsonStringify=function(e,n,r){var t=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(t=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}var i=JSON.stringify.call(this,e,n,r);try{t&&(Object.prototype.toJSON=t),o&&(Array.prototype.toJSON=o)}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}return i},n.jsonParse=function(e){return JSON.parse(e)};var o=r("./node_modules/cross-domain-safe-weakmap/src/index.js"),s=r("./node_modules/cross-domain-utils/src/index.js"),a=r("./src/conf/index.js");function c(e,n){for(var r=0;r<e.length;r++)n(e[r],r)}function u(e,n){for(var r in e)e.hasOwnProperty(r)&&n(e[r],r)}function l(e,n){Array.isArray(e)?c(e,n):"object"===(void 0===e?"undefined":t(e))&&null!==e&&u(e,n)}n.once=function(e){if(!e)return e;var n=!1;return function(){if(!n)return n=!0,e.apply(this,arguments)}},n.weakMapMemoize=function(e){var n=new o.WeakMap;return function(r){var t=n.get(r);return void 0!==t?t:(void 0!==(t=e.call(this,r))&&n.set(r,t),t)}}},"./src/public/client.js":function(e,n,r){n.__esModule=!0,n.send=void 0,n.request=l,n.sendToParent=function(e,n,r){var t=(0,i.getAncestor)();return t?d(t,e,n,r):new o.ZalgoPromise(function(e,n){return n(new Error("Window does not have a parent"))})},n.client=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.window)throw new Error("Expected options.window");var n=e.window;return{send:function(r,t){return d(n,r,t,e)}}};var t=r("./node_modules/cross-domain-safe-weakmap/src/index.js"),o=r("./node_modules/zalgo-promise/src/index.js"),i=r("./node_modules/cross-domain-utils/src/index.js"),s=r("./src/conf/index.js"),a=r("./src/drivers/index.js"),c=r("./src/lib/index.js"),u=r("./src/global.js");function l(e){return o.ZalgoPromise.try(function(){if(!e.name)throw new Error("Expected options.name");var n=e.name,r=void 0,t=void 0;if("string"==typeof e.window){var l=document.getElementById(e.window);if(!l)throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be a valid element id");if("iframe"!==l.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(!l.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");r=l.contentWindow}else if(e.window instanceof HTMLIFrameElement){if("iframe"!==e.window.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(e.window&&!e.window.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");e.window&&e.window.contentWindow&&(r=e.window.contentWindow)}else r=e.window;if(!r)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");var d=r;t=e.domain||s.CONSTANTS.WILDCARD;var f=e.name+"_"+(0,c.uniqueID)();if((0,i.isWindowClosed)(d))throw new Error("Target window is closed");var p=!1,m=u.global.requestPromises.get(d);m||(m=[],u.global.requestPromises.set(d,m));var h=o.ZalgoPromise.try(function(){if((0,i.isAncestor)(window,d))return(0,c.onChildWindowReady)(d,e.timeout||s.CONFIG.CHILD_WINDOW_TIMEOUT)}).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if((0,c.isRegex)(t)&&!e)return(0,c.sayHello)(d)}).then(function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if((0,c.isRegex)(t)){if(!(0,i.matchDomain)(t,r))throw new Error("Remote window domain "+r+" does not match regex: "+t.toString());t=r}if("string"!=typeof t&&!Array.isArray(t))throw new TypeError("Expected domain to be a string or array");var u=t;return new o.ZalgoPromise(function(r,t){var o=void 0;if(e.fireAndForget||(o={name:n,window:d,domain:u,respond:function(e,n){e||(p=!0,m.splice(m.indexOf(h,1))),e?t(e):r(n)}},(0,a.addResponseListener)(f,o)),(0,a.sendMessage)(d,{type:s.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,hash:f,name:n,data:e.data,fireAndForget:e.fireAndForget},u).catch(t),e.fireAndForget)return r();var c=s.CONFIG.ACK_TIMEOUT,l=e.timeout||s.CONFIG.RES_TIMEOUT,y=100;setTimeout(function r(){if(!p){if((0,i.isWindowClosed)(d))return o.ack?t(new Error("Window closed for "+n+" before response")):t(new Error("Window closed for "+n+" before ack"));if(c=Math.max(c-y,0),-1!==l&&(l=Math.max(l-y,0)),o.ack){if(-1===l)return;y=Math.min(l,2e3)}else{if(0===c)return t(new Error("No ack for postMessage "+n+" in "+(0,i.getDomain)()+" in "+s.CONFIG.ACK_TIMEOUT+"ms"));if(0===l)return t(new Error("No response for postMessage "+n+" in "+(0,i.getDomain)()+" in "+(e.timeout||s.CONFIG.RES_TIMEOUT)+"ms"))}setTimeout(r,y)}},y)})});return h.catch(function(){(0,a.markResponseListenerErrored)(f),(0,a.deleteResponseListener)(f)}),m.push(h),h})}function d(e,n,r,t){return(t=t||{}).window=e,t.name=n,t.data=r,l(t)}u.global.requestPromises=u.global.requestPromises||new t.WeakMap,n.send=d,u.global.send=d},"./src/public/config.js":function(e,n,r){n.__esModule=!0,n.CONSTANTS=n.CONFIG=void 0;var t=r("./src/conf/index.js");Object.defineProperty(n,"CONFIG",{enumerable:!0,get:function(){return t.CONFIG}}),Object.defineProperty(n,"CONSTANTS",{enumerable:!0,get:function(){return t.CONSTANTS}}),n.disable=function(){delete window[t.CONSTANTS.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",o.messageListener)};var o=r("./src/drivers/index.js")},"./src/public/index.js":function(e,n,r){n.__esModule=!0,n.parent=void 0;var t=r("./src/public/client.js");Object.keys(t).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return t[e]}})});var o=r("./src/public/server.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}})});var i=r("./src/public/config.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}})});var s=r("./node_modules/cross-domain-utils/src/index.js");n.parent=(0,s.getAncestor)()},"./src/public/server.js":function(e,n,r){n.__esModule=!0,n.on=void 0;var t="function"==typeof Symbol&&"symbol"==i(Symbol.iterator)?function(e){return void 0===e?"undefined":i(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":i(e)};n.listen=d,n.once=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments[2];"function"==typeof n&&(r=n,n={}),n=n||{},r=r||n.handler;var t=n.errorHandler,o=new s.ZalgoPromise(function(o,i){(n=n||{}).name=e,n.once=!0,n.handler=function(e){if(o(e),r)return r(e)},n.errorHandler=function(e){if(i(e),t)return t(e)}}),i=d(n);return o.cancel=i.cancel,o},n.listener=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(n,r){return f(n,e,r)}}};var o=r("./node_modules/cross-domain-utils/src/index.js"),s=r("./node_modules/zalgo-promise/src/index.js"),a=r("./src/lib/index.js"),c=r("./src/drivers/index.js"),u=r("./src/conf/index.js"),l=r("./src/global.js");function d(e){if(!e.name)throw new Error("Expected options.name");if(!e.handler)throw new Error("Expected options.handler");var n=e.name,r=e.window,i=e.domain,s={handler:e.handler,handleError:e.errorHandler||function(e){throw e},window:r,domain:i||u.CONSTANTS.WILDCARD,name:n},l=(0,c.addRequestListener)({name:n,win:r,domain:i},s);if(e.once){var d=s.handler;s.handler=(0,a.once)(function(){return l.cancel(),d.apply(this,arguments)})}if(s.window&&e.errorOnClose)var f=(0,a.safeInterval)(function(){r&&"object"===(void 0===r?"undefined":t(r))&&(0,o.isWindowClosed)(r)&&(f.cancel(),s.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){l.cancel()}}}function f(e,n,r){return"function"==typeof n&&(r=n,n={}),(n=n||{}).name=e,n.handler=r||n.handler,d(n)}n.on=f,l.global.on=f}})})}).call(this,r(6)(e))},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),o=u(r(1)),i=u(r(0)),s=u(r(5)),a=u(r(4)),c=u(r(3));function u(e){return e&&e.__esModule?e:{default:e}}var l=new(u(r(2)).default),d=function(){function e(n){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=n.data.config,this.currentUser=n.data.user,this.type=n.data.type||"FIELD",this.entry=new c.default(n,o.default,l),"FIELD"===this.type&&(this.field=new i.default(n,o.default,l)),this.window=new s.default(o.default),this.stack=new a.default(n.data.stack,o.default),o.default.on("entryUpdate",function(e){l.emitEvent("entryUpdate",[e])})}return t(e,[{key:"setReady",value:function(){return o.default.sendToParent("ready")}}],[{key:"initialize",value:function(){return o.default.sendToParent("init",{})}}]),e}();n.default=d},function(e,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var t=function(){function e(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(n,r,t){return r&&e(n.prototype,r),t&&e(n,t),n}}(),o=i(r(8));function i(e){return e&&e.__esModule?e:{default:e}}i(r(1)).default.CONFIG.LOG_LEVEL="error";var s=function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}return t(e,null,[{key:"init",value:function(){var e=this;return this._extension?Promise.resolve(this._extension):o.default.initialize().then(function(n){return e._extension=new o.default(n),Promise.resolve(e._extension)}).catch(function(e){return Promise.reject(e)})}},{key:"SDK_VERSION",get:function(){return"1.0.0"}}]),e}();n.default=s},function(e,n,r){"use strict";e.exports=r(9).default}])});
//# sourceMappingURL=ui-extensions-sdk.js.map